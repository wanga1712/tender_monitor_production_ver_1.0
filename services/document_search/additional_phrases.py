"""
MODULE: services.document_search.additional_phrases
RESPONSIBILITY: Provide additional search phrases/keywords for specific product categories.
ALLOWED: loguru.
FORBIDDEN: Database access, IO operations.
ERRORS: None.

Модуль для работы с дополнительными фразами для поиска.

Содержит:
- Генерацию списка дополнительных фраз
- Поиск дополнительных фраз в документах
"""

from __future__ import annotations

from pathlib import Path
from typing import Any, Dict, List
import re

from loguru import logger


def get_additional_search_phrases() -> List[str]:
    """
    Генерация дополнительных фраз для поиска по документации.
    
    Returns:
        Список фраз для поиска (в нижнем регистре)
    """
    phrases = []
    
    # 1. Композитные перильные ограждения - вариации
    composite_railing_phrases = [
        "композитное перильное ограждение",
        "композитные перильные ограждения",
        "перильное ограждение композитное",
        "перильные ограждения композитные",
        "перильные ограждения из композита",
        "перильное ограждение из композита",
        "композитное ограждение перильное",
        "композитные ограждения перильные",
        "стеклопластиковые перильные ограждения",
        "перильные ограждения стеклопластиковые",
        "перильные ограждения из стеклопластика",
        "перильное ограждение из стеклопластика",
        "стеклопластиковое перильное ограждение",
        "перильное ограждение стеклопластиковое",
        "перильные ограждения композит",
        "перильное ограждение композит",
        "композит перильные ограждения",
        "композит перильное ограждение",
    ]
    phrases.extend(composite_railing_phrases)
    
    # 2. Система внешнего армирования - вариации
    external_reinforcement_phrases = [
        "система внешнего армирования",
        "внешнее армирование",
        "армирование внешнее",
        "система армирования внешнего",
        "усиление углеволокном",
        "армирование углеволокном",
        "углеволокно для армирования",
        "армирование углеродным волокном",
        "усиление углеродным волокном",
        "fibarm",
        "carbonwrap",
        "monsterlot",
        "sika",
        "mapei",
    ]
    phrases.extend(external_reinforcement_phrases)
    
    # 3. Композитные водоотводные лотки - вариации
    composite_drainage_phrases = [
        "композитные водоотводные лотки",
        "водоотводные лотки композитные",
        "композитный водоотводный лоток",
        "водоотводный лоток композитный",
        "лотки водоотводные композитные",
        "лоток водоотводный композитный",
        "подвесные водоотводные лотки композитные",
        "композитные подвесные водоотводные лотки",
        "водоотводные лотки подвесные композитные",
        "подвесные композитные водоотводные лотки",
        "стеклопластиковые водоотводные лотки",
        "водоотводные лотки стеклопластиковые",
        "стеклопластиковый водоотводный лоток",
        "водоотводный лоток стеклопластиковый",
        "полимерные водоотводные лотки",
        "водоотводные лотки полимерные",
        "полимерный водоотводный лоток",
        "водоотводный лоток полимерный",
        "композитные лотки водоотводные",
        "композитный лоток водоотводный",
        "водоотводные лотки из композита",
        "водоотводный лоток из композита",
        "лотки из композита водоотводные",
        "лоток из композита водоотводный",
    ]
    phrases.extend(composite_drainage_phrases)

    # 4. Инъектирование и гидроизоляция - вариации
    injection_phrases = [
        "инъектирование",
        "иньектирование",
        "инъектировать",
        "инъекционные работы",
        "инъекционная гидроизоляция",
        "инъекционное заполнение",
        "инъекционная система",
        "гидроизоляция",
        "гидроизоляции",
        "гидроизоляционные работы",
        "гидроизоляционные материалы",
        "гидроизоляционные системы",
        "гидроизоляционный состав",
        "гидроизоляционные решения",
    ]
    phrases.extend(injection_phrases)

    # 5. Наливные полы - вариации
    self_leveling_phrases = [
        "наливные полы",
        "наливных полов",
        "наливной пол",
        "наливного пола",
        "наливные покрытия",
        "наливное покрытие",
        "наливной состав",
        "наливные смеси",
    ]
    phrases.extend(self_leveling_phrases)

    # 6. Промышленные полы - вариации
    industrial_floor_phrases = [
        "промышленные полы",
        "промышленных полов",
        "промышленный пол",
        "промышленного пола",
        "промышленные покрытия",
        "промышленное покрытие",
    ]
    phrases.extend(industrial_floor_phrases)

    # 7. Усиление конструкций - вариации
    reinforcement_phrases = [
        "усиление конструкций",
        "усиление конструкции",
        "усиление несущих конструкций",
        "усиление железобетонных конструкций",
        "усиление железобетонной конструкции",
        "усиление жб конструкций",
        "усиление жб конструкции",
        "усиление зданий",
        "усиление сооружений",
    ]
    phrases.extend(reinforcement_phrases)
    
    # Нормализуем все фразы (нижний регистр, убираем лишние пробелы)
    normalized_phrases = []
    for phrase in phrases:
        normalized = re.sub(r'\s+', ' ', phrase.strip().casefold())
        if normalized:
            normalized_phrases.append(normalized)
    
    logger.debug(f"Сгенерировано {len(normalized_phrases)} дополнительных фраз для поиска")
    return normalized_phrases

